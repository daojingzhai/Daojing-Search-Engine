java
连接
连接池
详解
httpwwwjavaweb1024comjavaJavaWebzhongji20150601736html
httpsblogcsdnnetfangquan1980articledetails52429903
对于
共享
资源
共享资源
有
一个
很
著名
的
设计
模式
设计模式
池
Resource
Pool
该
正是
为了
解决
频繁
分配
释放
所
造成
问题
为
我们
可以
采用
数据
据库
数据库
技术
基本
思想
就是
建立
缓冲
预先
在
池中
放入
一定
数量
当
需要
时
只
需
从
取出
使用
完毕
之后
再放
回去
通过
设定
最大
连接数
来
防止
系统
无尽
与
更为
为重
重要
更为重要
是
管理
机制
管理机制
监视
情况
开发
测试
及
性能
调整
提供
依据
什么
为什么
编程
语言
编程语言
交互
一种
方式
经常
会
听到
这么
一句
话
昂贵
有人
接受
这种
说法
却
不
知道
它
真正
含义
因此
下面
实例
解释
究竟
Mysql
创建
一段
代码
view
plaincopyprint
String
connUrl
jdbcmysqlyourdatabasedomainyourDBname
ClassforNamecommysqljdbcDriver
Connection
con
DriverManagergetConnection
了
对象
内部
都
执行
1DriverManager
检查
并
注册
驱动
程序
驱动程序
2commysqljdbcDriver
它会
类中
调用
connecturl
方法
3commysqljdbcDriver
connect
根据
请求
Socket
到
IP
yourdatabasedomain
默认
端口
3306
4
将
被
用来
查询
指定
最终
让
返回
得到
结果
简单
获取
要
背后
做
很多
消耗
事情
大多
时候
时间
比
sql
语句
还要
长
传统
如下
图
所示
用户
每次
向
获得
链接
而
通常
相对
较大
也
较长
假设
网站
一天
10
万
访问
访问量
服务
务器
服务器
就
万次
极大
浪费
并且
极易
内存
溢出
拓机
后
过程
关键
有限
这
一点
多用
多用户
网页
应用
应用程序
中
体现
尤为
突出
对
能
显著
影响
整个
伸缩
伸缩性
和
健壮
健壮性
能指
指标
性能指标
负责
允许
重复
重复使用
现有
不是
重新
注意
1
并发
使
具有
通用
通用性
必须
考虑
多线
线程
多线程
环境
即
这个
比较
好
因为
各个
自身
支持
像
javac
等等
synchronizedjavalockC
关键字
即可
确保
同步
2
事务
处理
事务处
事务处理
原子
性
此时
要求
操作
符合
ALLORNOTHING
原则
一组
SQL
要么
全做
全不做
２
个
公用
而且
各自
自己
头疼
即使
类
相应
可是
仍然
不能
确定
那个
对应
由于
进行
引起
为此
每
独占
实现
虽然
有点
但是
大大
降低
大大降低
事务管理
复杂
复杂性
３
对系统
很大
合理
提高
复用
度
从而
新
开销
同时
还
加快
速度
访问速度
可
List
把
已经
中去
统一
每当
没有
有没有
如果
合适
最合适
给
他
如何
找到
文章
议题
指出
抛出
异常
是否
由
专门
４
配置
维护
到底
应该
放置
多少
才能
最佳
采取
设置
最小
minConnection
maxConnection
等
参数
控制
比方
比方说
启动
系统启动
过
多则
慢
但
响应
响应速度
很快
过少
则
起来
却慢
这样
较
小
会快
实际
客户
来说
快些
数目
具体
看
软件
需求
上
呢
动态
静态
两种
策略
每隔
检测
发现
小于
补充
以
保证
正常
运转
空闲
不够
再
去
Tomcat
DBCP
其实
本质
讲
利用
Apache
Commons
不过
只不过
特定
功能
集成
tomcatdbcpjar
包中
法法
步骤
Contextxml
添加
html
Context
pathTomcatDbPools
docBaseTomcatDbPools
debug0
reloadabletrue
namejdbcmysql
_
authContainer
typejavaxsqlDataSource
driverClassNamecommysqljdbcDriver
url
jdbcmysqllocalhost3306test
usernameadmin
password123456
maxActive100
maxIdle30
maxWait10000
context
注
用
minIdle
最少
maxIdle
initialSize
初始
初始化
多个
数据源
serverxml
文件
上面
内容
直接
Host
节点
下
GlobalNamingResources
namemysql
factoryorgapachetomcatdbcpdbcpBasicDataSourceFactory
namejdbcTomcatDbPool1
urljdbcmysqllocalhost3306test
usernameroot
然后
contextxml
ContextContext
加入
ResourceLink
globalmysql
全局
所有
项目
resource
只是
重用
方便
tomcat
web
工程
你
不会
加载
就是说
也就是说
必要
此外
mysql
Java
以及
其他
依赖
包
放到
lib
目录
webxml
resourceref
元素
引用
JNDI
description
dbcpconnectdescription
resrefname
jdbcmysql
restypejavaxsqlDataSourcerestype
resauthContainerresauth
3
Web
ctx
new
InitialContext
DataSource
ds
ctxlookupjavacompenvjdbcmysql
conn
dsgetConnection
connclose
基金
组织
基金组织
开源
应
增加
两个
jar
Commonsdbcpjar
Commonspooljar
库
既
应用服务器
整合
独立
dbcp
配置文件
dbcpproperties
plain
地址
urljdbcmysqllocalhosttest
户名
用户名
密码
设为
0
表示
无
限制
maxActive30
数
超过
连
接将
标记
不可
maxIdle10
等待
等待时间
此
接到
maxWait1000
removeAbandonedTimeout
没用
废弃
回收
false
true
removeAbandonedtrue
300
秒
removeAbandonedTimeout180
工具
类如
jdbcUtils
块
import
javaioInputStream
javasqlConnection
javasqlResultSet
javasqlSQLException
javasqlStatement
javautilProperties
javaxsqlDataSource
orgapachecommonsdbcpBasicDataSourceFactory
public
classJdbcUtils
private
static
null
try
InputStream
in
JdbcUtils
DBCPclassgetClassLoadergetResourceAsStreamdbcpproperties
Properties
prop
proploadin
BasicDataSourceFactorycreateDataSourceprop
catch
Exception
e
throw
newExceptionInInitializerErrore
getConnectionthrows
SQLException
return
void
releaseConnection
ifconnnull
eprintStackTrace
PreparedStatement
st
ResultSet
rs
DBCPgetConnection
finally
DBCPreleaseconn
C3P0
c3p0
JDBC
绑定
JDBC3
规范
JDBC2
标准
扩展
一般
HibernateSpring
框架
一块
当然
单独
自动
连接功能
导入
c3p0jarmchangecommonsjar
Oracle
那么
c3p0oraclethinextraspre1jar
c3p0configxml
c3p0config
defaultconfig
property
namedriverClasscommysqljdbcDriverproperty
namejdbcUrljdbcmysqllocalhost3306anysearchproperty
nameuserrootproperty
namepassword123456property
nameacquireIncrement5property
nameinitialPoolSize10property
nameminPoolSize5property
namemaxPoolSize20property
nameacquireRetryAttempts30property
nameacquireRetryDelay1000property
nameautoCommitOnClosefalseproperty
namedconfig
nameMySQL
namejdbcUrljdbcmysqllocalhost3306test2property
还有
更
多
查阅
相关
资料
commchangev2c3p0ComboPooledDataSource
class
ComboPooledDataSource
newComboPooledDataSourceMySQL
C3P0getConnection
C3P0releaseconn
选择
供选择
比如
广泛
ProxoolProxool
sourceforge
易用
最为
监控
便于
泄漏
proxool
能够
更好
高
稳定
定性
稳定性
方面
略逊
于
dpcp
